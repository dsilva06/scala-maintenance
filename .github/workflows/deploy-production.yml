name: Deploy Production

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  deploy-production:
    if: ${{ secrets.PROD_DEPLOY_PROVIDER != '' && secrets.PROD_DEPLOY_TOKEN != '' }}
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Deploy production
        run: ./scripts/deploy-production.sh
        env:
          PROD_DEPLOY_PROVIDER: ${{ secrets.PROD_DEPLOY_PROVIDER }}
          PROD_DEPLOY_TOKEN: ${{ secrets.PROD_DEPLOY_TOKEN }}
          RELEASE_SHA: ${{ github.sha }}
